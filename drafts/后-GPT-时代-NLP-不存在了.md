---
categories:
- 编程语言
copyright: true
date: 2023-05-12 20:49:47
description: ''
slug: In-The-Post-GPT-Era-NLP-No-Longer-Exists
tags:
- GPT
- NLP
- Rasa
- 贾维斯
title: 后 GPT 时代，NLP 不存在了？
toc: true
image: /posts/视频是不能-P-的系列-Milvus-实现海量人脸快速检索/eye-g11309d339_1280.jpg
---
在刘慈欣老师的《三体》小说中，整个故事是以杨冬的死亡这条线索来展开的，而杨冬自杀的理由则是——**物理学不存在了**。随着 GPT-4 的发布，『NLP 已死』和『NLP不存在了』的声音开始不绝于耳。如果说杨冬眼中的物理学被颠覆源于质子的“欺骗”，那么，如今的大语言模型对于 NLP 的冲击，实则是它改变了 AI 能力触及最终用户的方式。回顾传统 NLP 中的技术方向，大概有信息抽取、文本挖掘、机器翻译、语音合成、语音识别、语义理解、句法分析等等，这些都可以看做是自然语言处理中的一个子任务或者是中间任务。因此，传统的 NLP 更像是大家在各自的领域里发光发热，提供多种不同的工具。当你需要对自然语言进行处理的时候，你必须将这些不同的工具结合起来，就像博主曾经使用过的结巴分词、SnowNLP、词袋模型、情感分析、TF-IDF……一样。反观如今的大语言模型，它更像是一个跳过了这些中间任务、直接面对最终任务的“智者”。因为，不管我们如何努力地去分词、标注词性、提取实体、分析句法、提取关键字、生成摘要……，我们最终的目的不过是令程序产生智能，让人类相信程序能够“理解”他们的意图，仅此而已。显然，在这点上，ChatGPT 和 Midjourney 都做到了。作为一个非科班的程序员，我无法科学而客观地评判 LLM 和 NLP 孰优孰劣。不过，我还是想分享一下这段时间开发“贾维斯”过程中的一点点心得，希望对大家有所启发。

# Hey Jarvis

在将小爱同学接入 ChatGPT 以后，我开始考虑怎么样在智能和功能上找到一种平衡，因为 ChatGPT 虽然提升了小爱同学在聊天方面的智能，可同样破坏了当下智能音箱普遍使用的“指令集”，你无法运用 ChatGPT 的这种“聪慧”让它真正地帮你做点事情。所以，我大概率要再次发明“智能音箱”，可我想知道，有了 ChatGPT 的加持以后，它到底能智能到哪种程度？带着这样一个想法，我开始从头编写贾维斯——一个基于 ChatGPT 的人工智能管家，灵感来源于钢铁侠的人工智能管家 Jarvis。目前，它可以查询日期/时间、检索信息、播放音乐、控制米家/电脑、打开应用、讲笑话、查询天气、编程。下面是博主发布在 Bilibili 的视频：

{{<bilibili BV1TP411m7Kk>}}

你可能会好奇这些功能都是如何实现的？如图所示，下面是“贾维斯”的整体设计思路：

![贾维斯整体设计思路说明](/posts/后-GPT-时代-NLP-不存在了/Jarvis.drawio.png)

从整体而言，整个程序并不算特别复杂，因为语音唤醒、语音识别、语音合成这些均已有非常成熟的方案。在接入 ChatGPT 以后，我开始尝试为它扩展更多的功能。这个时候，我了解到自然语言理解(NLU)的这个方向，并且它依然属于自然语言处理(NLP)这个范畴，更具体的关键词则为意图识别或者意图提取。以查询日期这个功能为例，我只需要在某个函数上添加“路由”，即可为贾维斯设计不同的“技能”：

```python
@trigger.route(keywords=['查询日期','询问日期','日期查询'])
def report_date(input):
    now = datetime.datetime.now()
    week_list = ['星期一','星期二','星期三','星期四','星期五','星期六','星期日']
    formated = now.strftime('%Y年%m月%d日')
    week_day = week_list[now.weekday()]
    history = today_on_history()
    if history != None:
        return f'今天是{formated}，{week_day}。{history}。'
    else:
        return f'今天是{formated}，{week_day}。'
```

此时，问题就被转化为如何识别或者提取一句话中的真实意图。坦白地讲，面对人类这种口是心非的动物，想要了解其真实意图是非常困难的。譬如，人类普遍希望别人能理解自己、能“懂我”，可没有人会喜欢被别人一眼看穿。因此，我们这里讨论的意图，特指那些动宾结构的指令型用语，例如：打开客厅的灯、查询明天的天气等等。不论屏幕前的你对 AI 持何种态度，我想说的是，AI 已然参与到我日常的编程和写作中，这正是我开发贾维斯的动力所在，我希望它能参与到更多的事项中去，我甚至想让它取代家里的小爱同学。

# 基于 ChatGPT 实现意图提取

对笔者而言，在接触到 ChatGPT 以后，编程语言就仿佛进入了一个新的时代——魔法时代。因为无论你需要大语言模型帮你做什么，你要做的第一件事情就是编写 Prompt。而关于这件事情本身，则像极了魔法师在施法前吟唱咒语。所以，你说未来会出现那种被称之为“魔法吟唱师”的职业吗？当然，更有意思的点在于，如果说目前的编程语言都是过程式的，那么，在进入魔法时代以后，这一切就会变成描述式的。关于意图提取这个话题，你打算怎么样向 AI 解释它呢？总之，下面是我的实现：

```python
# 
intent_extractor_prompt = '''
    我想让你扮演我的自然语言处理工具，当我告诉你一句话的时候，你可以对它进行分词、词法分析、词性分析、上下文分析、主题建模/抽取，
    你可以自由地使用结巴分词、nltk 或者是 SnowNLP 这些工具，你需要猜测我这句话中的意图，并用下面的形式表示出来：
    ```
    {
        "query": "查询许嵩的资料",
        "intent": {
            "name": "查询",
            "confidence": 0.95
        },
        "entities": [
            {
                "entity": "name",
                "value": "许嵩",
                "start": 2,
                "end": 4,
                "confidence": 0.98
            }
        ]
    }
    ```
    其中，`query` 字段表示原始查询文本，`intent` 字段表示查询意图，`entities` 字段表示查询中提取的实体信息。
    在这个示例中，意图为查询，置信度为0.95，实体为人名，值为“许嵩”，起始位置为2，结束位置为4，置信度为0.98。
    你只需要返回给我这样一段 JSON，不需要任何冗余的信息。需要注意的是，你要对相似的意图进行归类，使用一个统一的意图进行描述。我的问题是：
'''
```

在将我的输入的指令和这段提示词一起发送给 ChatGPT 以后，我实际上获得了一个具备意图提取能力的 API 接口。你会注意到，我并没有使用任何传统 NLP 的工具或者技术，但我确实实现了类似得功能。我曾经测试过 ChatGPT 的英文翻译效果，我发现，它的翻译效果甚至比主流的翻译工具要好很多。在这种情况下，传统 NLP 无论怎么努力都注定赶不上 LLM，难怪人们会发出“NLP已死”这种声音啊！还记得刘慈欣老师书中的“降维打击”这一概念吗？传统的 NLP 一直致力于优化模型和算法，甚至 GPT 使用的这些技术都不算特别先进，可在海量数据和大规模算力面前，GPT 最终呈现出来的效果的确比这些方案要好，你不得不说这是一种奇迹。下面展示的是博主通过 ChatGPT 提取出来的意图：

![通过 ChatGPT 提取意图](/posts/后-GPT-时代-NLP-不存在了/ChatGPTIntentExtractor.png)

# 基于 Rasa NLU 实现意图提取
# 结论


